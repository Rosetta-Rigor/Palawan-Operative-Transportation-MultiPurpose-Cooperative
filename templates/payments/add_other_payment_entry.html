{% extends 'base_no_sidebar.html' %}
{% load static %}
{% load widget_tweaks %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/admin_payments.css' %}">
<link rel="stylesheet" href="{% static 'css/admin_forms.css' %}">
{% endblock %}

{% block content %}
<div class="content admin-dashboard">
    <div class="payments-container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-8">
                <div class="payment-form-card">
                    <div class="payment-form-header" style="position: relative;">
                        <a href="{% url 'other_payments_view' year.id %}" class="member-back-btn" title="Back to Other Payments">
                            <i class="las la-arrow-left"></i>
                        </a>
                        <h4 class="payment-form-title">
                            <i class="las la-money-bill-wave"></i> Add Other Payment Entry
                        </h4>
                        <p class="payment-form-subtitle">Record a payment entry for {{ year.year }}</p>
                    </div>
                    <div class="payment-form-content">
                        <form method="POST">
                            {% csrf_token %}
                            
                            {% if form.non_field_errors %}
                                <div class="alert alert-danger">{{ form.non_field_errors }}</div>
                            {% endif %}
                            
                            <div class="form-group">
                                <label for="{{ form.payment_type.id_for_label }}">Payment Type <span class="text-danger">*</span></label>
                                <select name="{{ form.payment_type.name }}" id="{{ form.payment_type.id_for_label }}" class="form-control" required>
                                    <option value="">-- Select Payment Type --</option>
                                    {% for type in other_payment_types %}
                                        <option value="{{ type.id }}" {% if form.payment_type.value == type.id %}selected{% endif %}>{{ type.name }}</option>
                                    {% endfor %}
                                </select>
                                {% if form.payment_type.errors %}
                                    <div class="text-danger small">{{ form.payment_type.errors }}</div>
                                {% endif %}
                                <small class="form-text text-muted">Only "Other" payment types are shown</small>
                            </div>

                            <div class="form-group">
                                <label for="{{ form.member.id_for_label }}">Member <span class="optional-badge">Optional</span></label>
                                {{ form.member|add_class:"form-control" }}
                                {% if form.member.errors %}
                                    <div class="text-danger small">{{ form.member.errors }}</div>
                                {% endif %}
                                <small class="form-text text-muted">Select a member if this payment is associated with one</small>
                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="{{ form.month.id_for_label }}">Month <span class="text-danger">*</span></label>
                                    <select name="{{ form.month.name }}" id="{{ form.month.id_for_label }}" class="form-control" required>
                                        <option value="">-- Select Month --</option>
                                        <option value="1" {% if form.month.value == 1 %}selected{% endif %}>January</option>
                                        <option value="2" {% if form.month.value == 2 %}selected{% endif %}>February</option>
                                        <option value="3" {% if form.month.value == 3 %}selected{% endif %}>March</option>
                                        <option value="4" {% if form.month.value == 4 %}selected{% endif %}>April</option>
                                        <option value="5" {% if form.month.value == 5 %}selected{% endif %}>May</option>
                                        <option value="6" {% if form.month.value == 6 %}selected{% endif %}>June</option>
                                        <option value="7" {% if form.month.value == 7 %}selected{% endif %}>July</option>
                                        <option value="8" {% if form.month.value == 8 %}selected{% endif %}>August</option>
                                        <option value="9" {% if form.month.value == 9 %}selected{% endif %}>September</option>
                                        <option value="10" {% if form.month.value == 10 %}selected{% endif %}>October</option>
                                        <option value="11" {% if form.month.value == 11 %}selected{% endif %}>November</option>
                                        <option value="12" {% if form.month.value == 12 %}selected{% endif %}>December</option>
                                    </select>
                                    {% if form.month.errors %}
                                        <div class="text-danger small">{{ form.month.errors }}</div>
                                    {% endif %}
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="{{ form.amount_paid.id_for_label }}">Amount Paid <span class="text-danger">*</span></label>
                                    <div class="amount-input-wrapper">
                                        <span class="currency-prefix">â‚±</span>
                                        {{ form.amount_paid|add_class:"form-control" }}
                                    </div>
                                    {% if form.amount_paid.errors %}
                                        <div class="text-danger small">{{ form.amount_paid.errors }}</div>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="form-actions">
                                <a href="{% url 'other_payments_view' year.id %}" class="btn btn-secondary">
                                    <i class="fas fa-times"></i> Cancel
                                </a>
                                <button type="submit" class="btn btn-success">
                                    <i class="fas fa-save"></i> Record Payment
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
